---
import { projects } from "../../assets/data";
import Icon from "../Icon.astro";

export interface ProjectInterface {
  name: string;
  slug: string;
  repoName: string;
  description: string;
  image: any;
  logo?: any;
  status: string;
  linkToProject: string;
  hasCoverImage: boolean;
  hidden: boolean;
}

const slug = Astro.params.slug;

try {
  const res = await fetch(
    `https://raw.githubusercontent.com/gianluigitrontini/progetti-portfolio/main/${slug}/README.md`
  );
  const resText = await res.text();
} catch (error) {
  console.log(error);
}

// @ts-ignore
const project: ProjectInterface = projects.find(
  (prj: ProjectInterface) => prj.slug === Astro.params.slug
);
---

<section class="flex flex-col lg:flex-row p-0 overflow-hidden">
  <!-- <MobileHeader class="block md:hidden" project={project} /> -->

  {/* Content Block */}
  <div class="lg:w-2/3 h-full overflow-auto lg:mr-[33%]">
    <div class="container sm">
      <a href={"/#projects"} class="hidden lg:block lg:fixed top-8 left-4">
        <span class="close-animation-wrapper hover:text-[#38a7ca]">
          <span class="close-animation"></span>
          <Icon name="CloseIcon" />
        </span>
      </a>

      <a href={"/#projects"} class="block lg:hidden">
        <span class="my-4 block uppercase underline">Back to Homepage</span>
      </a>

      {/* Project Content */}
      <main class="lg:min-h-[100vh] pb-64 pt-4 lg:pb-4 lg:flex">
        <section id="projects-description" class="text-left py-4 w-full">
          <!-- {
            description.error && (
              <div class="flex justify-center items-center h-full">
                <div class="bg-red-100 border border-red-200 rounded-sm p-4 ">
                  {description.error}
                </div>
              </div>
            )
          } -->
          DESCRIZIONE

          <!-- {
            description.description && (
              // <ReactMarkdown remarkPlugins={[remarkGfm]}>
              //   {description.description}
              // </ReactMarkdown>
            )
          } -->
        </section>
      </main>
    </div>
  </div>

  <div
    class="lg:w-1/3 flex flex-col fixed left-0 lg:left-auto right-0 bottom-0 lg:top-0"
  >
    <div
      class="previous-next-gradient flex-1 flex flex-col justify-between bg-gray-50 p-4 lg:pt-8"
    >
      <div class="hidden md:flex flex-col flex-1 gap-4">
        {
          project.logo && (
            <img
              src={project.logo}
              class="mr-auto max-w-[12rem] h-20 object-contain"
              alt=""
            />
          )
        }

        <div class="text-left font-bold w-full">
          {
            project.linkToProject ? (
              <a
                href={project.linkToProject}
                class="inline-flex items-center text-xl"
                target="_blank"
                rel="noreferrer"
              >
                {project.name}
                <Icon name="OpenLinkIcon" />
              </a>
            ) : (
              <h3 class="text-xl">{project.name}</h3>
            )
          }

          <p class="font-body text-gray-500">{project.description}</p>
        </div>
      </div>

      <!-- <div class="w-full flex flex-col items-center gap-4 pt-12">
        <a href={`/projects/${previousProject.slug}`} class="w-full">
          <button
            class="btn btn-outline w-full"
            onClick={() => setProject(previousProject)}
          >
            &#8592; {previousProject.name}
          </button>
        </a>

        <a href={`/projects/${nextProject.slug}`} class="w-full">
          <button class="btn w-full" onClick={() => setProject(nextProject)}>
            {nextProject.name} &#8594;
          </button>
        </a>

        <a href={"/#projects"} class="hidden lg:block lg:fixed top-8 left-4">
          <span class="close-animation-wrapper hover:text-[#38a7ca]">
            <span class="close-animation"></span>
            <CloseIcon />
          </span>
        </a>

        <a href={"/#projects"} class="block lg:hidden">
          <span class="my-4 block uppercase underline">Back to Homepage</span>
        </a>
      </div> -->
    </div>
  </div>
</section>

<!-- <div class="flex flex-col items-center justify-center h-screen">
  <p class="text-xl text-center">
    404 <br /> The page cannot be found
  </p>
  <a href={"/"}>
    <button class="btn my-4">Go to Homepage</button>
  </a>
</div> -->
